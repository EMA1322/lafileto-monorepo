<!-- Admin / Categories view -->
<!-- CSS del módulo cargado vía code-splitting -->
<link rel="stylesheet" href="/src/styles/categories.css" />

<section
  id="categories-view"
  class="categories"
  data-module="categories"
  aria-labelledby="categories-title"
  role="region"
>
  <header class="categories__header">
    <div class="categories__heading">
      <h2 id="categories-title" class="categories__title">Categorías</h2>
      <p class="categories__subtitle">Organizá y administrá las categorías del catálogo.</p>
    </div>

    <div class="categories__toolbar" role="group" aria-label="Búsqueda y filtros de categorías">
      <div class="categories__control categories__control--search">
        <label for="categories-search" class="sr-only">Buscar por nombre</label>
        <input
          id="categories-search"
          class="form-control form-control--dense categories__search"
          type="search"
          name="search"
          placeholder="Buscar por nombre…"
          autocomplete="off"
          inputmode="search"
        />
      </div>

      <div class="categories__control">
        <label for="categories-filter-active" class="sr-only">Filtrar por estado</label>
        <select
          id="categories-filter-active"
          class="form-control form-control--dense categories__select"
          name="filter-active"
          data-filter="status"
        >
          <option value="all" selected>Todas</option>
          <option value="active">Activas</option>
          <option value="inactive">Inactivas</option>
        </select>
      </div>

      <div class="categories__control categories__control--order">
        <label for="categories-order" class="sr-only">Ordenar por nombre</label>
        <select
          id="categories-order"
          class="form-control form-control--dense categories__select"
          name="order"
          data-order="name"
        >
          <option value="asc" selected>Nombre ascendente</option>
          <option value="desc">Nombre descendente</option>
        </select>
      </div>

      <div class="categories__control categories__control--actions">
        <button id="categories-filter-clear" class="btn btn--ghost btn--sm" type="button">Limpiar filtros</button>
        <button
          id="categories-refresh"
          class="btn btn--ghost btn--icon categories__toolbarButton"
          type="button"
          aria-label="Recargar categorías"
          title="Recargar categorías"
        >
          <span class="icon icon--sm" data-icon="refresh" aria-hidden="true"></span>
        </button>
        <button
          id="categories-create"
          class="btn btn--primary"
          type="button"
          data-action="new"
          data-rbac-action="write"
          data-rbac-hide
          hidden
        >
          + Nueva
        </button>
      </div>
    </div>
  </header>

  <section
    class="categories__content is-loading"
    aria-live="polite"
    aria-busy="false"
    data-status="loading"
  >
    <div class="categories__state categories__state--loading" id="categories-loading" role="status">
      <span class="categories__spinner" aria-hidden="true"></span>
      <p>Cargando categorías…</p>
    </div>

    <div class="categories__state categories__state--error" id="categories-error" role="alert" hidden>
      <p id="categories-error-message">No pudimos cargar las categorías. Intentá nuevamente.</p>
      <button id="categories-retry" class="btn btn--ghost btn--sm" type="button">Reintentar</button>
    </div>

    <div class="categories__state categories__state--empty" id="categories-empty" role="status" hidden>
      <p>No encontramos categorías con estos filtros.</p>
      <button id="categories-empty-clear" class="btn btn--ghost btn--sm" type="button">Limpiar filtros</button>
    </div>

    <div class="table-wrapper categories__tableWrap" id="categories-table-wrapper" hidden>
      <table id="categories-table" class="data-table categories__table" role="table">
        <caption class="sr-only">Listado de categorías</caption>
        <thead>
          <tr>
            <th scope="col">Nombre</th>
            <th scope="col">Imagen</th>
            <th scope="col">Productos</th>
            <th scope="col">Estado</th>
            <th scope="col" class="categories__th-actions">Acciones</th>
          </tr>
        </thead>
        <tbody id="categories-tbody" class="categories__tbody"></tbody>
      </table>
    </div>
  </section>

  <footer class="categories__footer" aria-label="Paginación de categorías">
    <div id="categories-summary" class="categories__summary">—</div>
    <div class="categories__pager">
      <button
        id="categories-page-prev"
        class="btn btn--ghost btn--sm"
        type="button"
        aria-label="Página anterior"
        data-page="1"
      >◀</button>
      <span id="categories-page-indicator" class="categories__page">1 / 1</span>
      <button
        id="categories-page-next"
        class="btn btn--ghost btn--sm"
        type="button"
        aria-label="Página siguiente"
        data-page="1"
      >▶</button>
    </div>
  </footer>

  <!-- Templates para modales -->
  <template id="tpl-category-form">
    <div class="categories__modal">
      <header class="categories__modalHeader">
        <h3 id="category-modal-title" class="categories__modalTitle">Nueva categoría</h3>
      </header>
      <form id="category-form" class="categories__form" novalidate>
        <fieldset class="categories__formFields">
          <legend class="sr-only">Formulario de categoría</legend>

          <div class="categories__formField">
            <label for="category-name">Nombre</label>
            <input
              id="category-name"
              name="name"
              class="form-control"
              type="text"
              required
              minlength="2"
              maxlength="80"
              autocomplete="off"
              placeholder="Ej: Pizzas"
              aria-describedby="category-name-error"
            />
            <p id="category-name-error" class="form-error" hidden>Ingresá un nombre válido (2-80 caracteres).</p>
          </div>

          <div class="categories__formField">
            <label for="category-imageUrl">Imagen (URL)</label>
            <input
              id="category-imageUrl"
              name="imageUrl"
              class="form-control"
              type="url"
              inputmode="url"
              autocomplete="off"
              placeholder="https://ejemplo.com/imagen.jpg"
              aria-describedby="category-imageUrl-hint category-imageUrl-error"
            />
            <small id="category-imageUrl-hint" class="form-hint">Opcional. Debe ser una URL accesible con https://.</small>
            <p id="category-imageUrl-error" class="form-error" hidden>Ingresá una URL válida (https://…)</p>
          </div>
        </fieldset>

        <footer class="categories__formActions">
          <button type="button" class="btn btn--outline" data-close-modal>Cancelar</button>
          <button id="category-submit" type="submit" class="btn btn--primary">Guardar</button>
        </footer>
      </form>
    </div>
  </template>

  <template id="tpl-category-delete">
    <div class="categories__modal">
      <header class="categories__modalHeader">
        <h3 id="category-delete-title" class="categories__modalTitle">Eliminar categoría</h3>
      </header>
      <div class="categories__modalBody">
        <p id="category-delete-message"></p>
      </div>
      <footer class="categories__formActions">
        <button type="button" class="btn btn--outline" data-close-modal>Cancelar</button>
        <button id="category-confirm-delete" type="button" class="btn btn--primary">Eliminar</button>
      </footer>
    </div>
  </template>

  <template id="tpl-category-view">
    <div class="categories__modal categories__modal--view" role="dialog" aria-modal="true">
      <header class="categories__modalHeader">
        <h3 id="category-view-title" class="categories__modalTitle">Detalle de categoría</h3>
      </header>
      <div class="categories__modalBody categories__modalBody--view">
        <dl class="categories__details" aria-label="Información de la categoría">
          <div class="categories__detailsRow">
            <dt>Nombre</dt>
            <dd data-field="category-name">—</dd>
          </div>
          <div class="categories__detailsRow">
            <dt>Imagen</dt>
            <dd>
              <div class="categories__detailsImage" data-field="category-image-wrapper">
                <img data-field="category-image" alt="" hidden />
                <span data-field="category-image-fallback">Sin imagen</span>
              </div>
            </dd>
          </div>
          <div class="categories__detailsRow">
            <dt>Estado</dt>
            <dd data-field="category-status"></dd>
          </div>
        </dl>

        <div class="categories__switchSection" data-rbac-action="update" data-rbac-hide>
          <h4 class="categories__switchTitle">Estado de la categoría</h4>
          <p id="category-view-switch-hint" class="categories__switchHint">
            Activá o desactivá la categoría desde este panel.
          </p>
          <button
            id="category-view-switch"
            class="categories__switch"
            type="button"
            role="switch"
            aria-checked="false"
            aria-describedby="category-view-switch-hint"
            data-rbac-action="update"
            data-rbac-hide
            data-role="active-switch"
          >
            <span class="categories__switchTrack" aria-hidden="true">
              <span class="categories__switchThumb"></span>
            </span>
            <span class="categories__switchLabel" data-role="active-switch-label">Inactivo</span>
          </button>
        </div>
      </div>
      <footer class="categories__formActions categories__viewActions">
        <button id="category-view-close" type="button" class="btn btn--outline" data-close-modal>Cerrar</button>
        <button id="category-view-confirm" type="button" class="btn btn--primary" data-rbac-action="update" data-rbac-hide disabled>Guardar cambios</button>
      </footer>
    </div>
  </template>
</section>
